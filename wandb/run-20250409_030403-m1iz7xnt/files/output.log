[2025-04-09 03:04:06,474] [INFO] [checkpointing.py:529:forward] Activation Checkpointing Information
[2025-04-09 03:04:06,474] [INFO] [checkpointing.py:530:forward] ----Partition Activations False, CPU CHECKPOINTING False
[2025-04-09 03:04:06,474] [INFO] [checkpointing.py:531:forward] ----contiguous Memory Checkpointing False with None total layers
[2025-04-09 03:04:06,474] [INFO] [checkpointing.py:533:forward] ----Synchronization False
[2025-04-09 03:04:06,474] [INFO] [checkpointing.py:534:forward] ----Profiling time in checkpointing False
Epoch 0, Loss: 0.021484375, Positive Score: -0.23828125, Negative Score: -0.259765625
/home/li/anaconda3/envs/LLMs/lib/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/home/li/anaconda3/envs/LLMs/lib/python3.11/site-packages/deepspeed/runtime/zero/stage_1_and_2.py:1829: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  overflow_gpu = get_accelerator().ByteTensor([overflow])
Epoch 0, Loss: 0.015625, Positive Score: -0.26171875, Negative Score: -0.27734375
Epoch 0, Loss: 0.00390625, Positive Score: -0.248046875, Negative Score: -0.251953125
Epoch 0, Loss: 0.0078125, Positive Score: -0.27734375, Negative Score: -0.28515625
Epoch 0, Loss: -0.0126953125, Positive Score: -0.248046875, Negative Score: -0.2353515625
Epoch 0, Loss: -0.0048828125, Positive Score: -0.251953125, Negative Score: -0.2470703125
Epoch 0, Loss: 0.017578125, Positive Score: -0.25390625, Negative Score: -0.271484375
Epoch 0, Loss: 0.005859375, Positive Score: -0.2734375, Negative Score: -0.279296875
Epoch 0, Loss: 0.001953125, Positive Score: -0.271484375, Negative Score: -0.2734375
Epoch 0, Loss: 0.005859375, Positive Score: -0.232421875, Negative Score: -0.23828125
[2025-04-09 03:04:47,220] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=10, lr=[1e-05, 1e-05], mom=[(0.9, 0.99), (0.9, 0.99)]
[2025-04-09 03:04:47,221] [INFO] [timer.py:215:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=0.24666740483134023, CurrSamplesPerSec=0.20370874577640968, MemAllocated=5.52GB, MaxMemAllocated=11.15GB
Epoch 0, Loss: 0.0087890625, Positive Score: -0.2451171875, Negative Score: -0.25390625
Epoch 0, Loss: 0.005859375, Positive Score: -0.2578125, Negative Score: -0.263671875
Epoch 0, Loss: -0.029296875, Positive Score: -0.287109375, Negative Score: -0.2578125
Epoch 0, Loss: 0.0078125, Positive Score: -0.2578125, Negative Score: -0.265625
Epoch 0, Loss: -0.0078125, Positive Score: -0.265625, Negative Score: -0.2578125
Epoch 0, Loss: -0.00390625, Positive Score: -0.263671875, Negative Score: -0.259765625
Epoch 0, Loss: 0.01953125, Positive Score: -0.255859375, Negative Score: -0.275390625
Epoch 0, Loss: 0.0185546875, Positive Score: -0.2392578125, Negative Score: -0.2578125
Epoch 0, Loss: 0.0, Positive Score: -0.2578125, Negative Score: -0.2578125
Epoch 0, Loss: -0.001953125, Positive Score: -0.26171875, Negative Score: -0.259765625
[2025-04-09 03:05:26,639] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=20, lr=[1e-05, 1e-05], mom=[(0.9, 0.99), (0.9, 0.99)]
[2025-04-09 03:05:26,640] [INFO] [timer.py:215:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=0.25061535183027517, CurrSamplesPerSec=0.3138815700065316, MemAllocated=5.52GB, MaxMemAllocated=11.37GB
Epoch 0, Loss: 0.009765625, Positive Score: -0.251953125, Negative Score: -0.26171875
Epoch 0, Loss: -0.0107421875, Positive Score: -0.2373046875, Negative Score: -0.2265625
Epoch 0, Loss: 0.009765625, Positive Score: -0.271484375, Negative Score: -0.28125
Epoch 0, Loss: -0.021484375, Positive Score: -0.275390625, Negative Score: -0.25390625
Epoch 0, Loss: 0.005859375, Positive Score: -0.265625, Negative Score: -0.271484375
Epoch 0, Loss: -0.0078125, Positive Score: -0.26171875, Negative Score: -0.25390625
Epoch 0, Loss: 0.0126953125, Positive Score: -0.2294921875, Negative Score: -0.2421875
Epoch 0, Loss: -0.001953125, Positive Score: -0.259765625, Negative Score: -0.2578125
Epoch 0, Loss: 0.01171875, Positive Score: -0.25390625, Negative Score: -0.265625
Epoch 0, Loss: -0.01171875, Positive Score: -0.251953125, Negative Score: -0.240234375
[2025-04-09 03:06:10,374] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=30, lr=[1e-05, 1e-05], mom=[(0.9, 0.99), (0.9, 0.99)]
[2025-04-09 03:06:10,375] [INFO] [timer.py:215:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=0.2423687746177931, CurrSamplesPerSec=0.18245263470088072, MemAllocated=5.52GB, MaxMemAllocated=11.37GB
Epoch 0, Loss: -0.013671875, Positive Score: -0.271484375, Negative Score: -0.2578125
Epoch 1, Loss: -0.021484375, Positive Score: -0.25390625, Negative Score: -0.232421875
Epoch 1, Loss: 0.0, Positive Score: -0.265625, Negative Score: -0.265625
Epoch 1, Loss: 0.0078125, Positive Score: -0.244140625, Negative Score: -0.251953125
Epoch 1, Loss: 0.0234375, Positive Score: -0.25, Negative Score: -0.2734375
Epoch 1, Loss: 0.025390625, Positive Score: -0.234375, Negative Score: -0.259765625
Epoch 1, Loss: 0.015625, Positive Score: -0.26953125, Negative Score: -0.28515625
Epoch 1, Loss: 0.0205078125, Positive Score: -0.2392578125, Negative Score: -0.259765625
Epoch 1, Loss: -0.01171875, Positive Score: -0.259765625, Negative Score: -0.248046875
Epoch 1, Loss: -0.005859375, Positive Score: -0.26953125, Negative Score: -0.263671875
[2025-04-09 03:06:55,050] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=40, lr=[1e-05, 1e-05], mom=[(0.9, 0.99), (0.9, 0.99)]
[2025-04-09 03:06:55,050] [INFO] [timer.py:215:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=0.23736101359561465, CurrSamplesPerSec=0.31383746313200855, MemAllocated=5.52GB, MaxMemAllocated=14.17GB
Epoch 1, Loss: 0.013671875, Positive Score: -0.25, Negative Score: -0.263671875
Epoch 1, Loss: -0.013671875, Positive Score: -0.26171875, Negative Score: -0.248046875
Epoch 1, Loss: 0.01953125, Positive Score: -0.240234375, Negative Score: -0.259765625
Epoch 1, Loss: 0.021484375, Positive Score: -0.2265625, Negative Score: -0.248046875
Epoch 1, Loss: 0.01171875, Positive Score: -0.26953125, Negative Score: -0.28125
Epoch 1, Loss: 0.009765625, Positive Score: -0.228515625, Negative Score: -0.23828125
Epoch 1, Loss: -0.00390625, Positive Score: -0.27734375, Negative Score: -0.2734375
Epoch 1, Loss: -0.021484375, Positive Score: -0.255859375, Negative Score: -0.234375
Epoch 1, Loss: 0.00390625, Positive Score: -0.236328125, Negative Score: -0.240234375
Epoch 1, Loss: 0.013671875, Positive Score: -0.240234375, Negative Score: -0.25390625
[2025-04-09 03:07:47,409] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=50, lr=[1e-05, 1e-05], mom=[(0.9, 0.99), (0.9, 0.99)]
[2025-04-09 03:07:47,409] [INFO] [timer.py:215:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=0.22597085073043052, CurrSamplesPerSec=0.2967120057006455, MemAllocated=5.52GB, MaxMemAllocated=15.38GB
Epoch 1, Loss: 0.0341796875, Positive Score: -0.2255859375, Negative Score: -0.259765625
Epoch 1, Loss: 0.021484375, Positive Score: -0.265625, Negative Score: -0.287109375
Epoch 1, Loss: 0.0126953125, Positive Score: -0.232421875, Negative Score: -0.2451171875
Epoch 1, Loss: -0.00390625, Positive Score: -0.267578125, Negative Score: -0.263671875
Epoch 1, Loss: -0.0087890625, Positive Score: -0.240234375, Negative Score: -0.2314453125
Epoch 1, Loss: 0.01953125, Positive Score: -0.24609375, Negative Score: -0.265625
Epoch 1, Loss: 0.001953125, Positive Score: -0.251953125, Negative Score: -0.25390625
Epoch 1, Loss: 0.03125, Positive Score: -0.240234375, Negative Score: -0.271484375
Epoch 1, Loss: -0.005859375, Positive Score: -0.275390625, Negative Score: -0.26953125
Epoch 1, Loss: -0.001953125, Positive Score: -0.259765625, Negative Score: -0.2578125
[2025-04-09 03:08:26,510] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=60, lr=[1e-05, 1e-05], mom=[(0.9, 0.99), (0.9, 0.99)]
[2025-04-09 03:08:26,511] [INFO] [timer.py:215:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=0.23062704376130366, CurrSamplesPerSec=0.3132958062935475, MemAllocated=5.52GB, MaxMemAllocated=15.38GB
Epoch 1, Loss: 0.0078125, Positive Score: -0.26953125, Negative Score: -0.27734375
Epoch 1, Loss: 0.01171875, Positive Score: -0.259765625, Negative Score: -0.271484375
Epoch 1, Loss: 0.0078125, Positive Score: -0.255859375, Negative Score: -0.263671875
Epoch 2, Loss: 0.0048828125, Positive Score: -0.2333984375, Negative Score: -0.23828125
Epoch 2, Loss: 0.00390625, Positive Score: -0.2353515625, Negative Score: -0.2392578125
Epoch 2, Loss: 0.0, Positive Score: -0.2734375, Negative Score: -0.2734375
Epoch 2, Loss: 0.01953125, Positive Score: -0.259765625, Negative Score: -0.279296875
Epoch 2, Loss: 0.01953125, Positive Score: -0.25, Negative Score: -0.26953125
Epoch 2, Loss: -0.0234375, Positive Score: -0.251953125, Negative Score: -0.228515625
Epoch 2, Loss: 0.001953125, Positive Score: -0.279296875, Negative Score: -0.28125
[2025-04-09 03:09:10,278] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=70, lr=[1e-05, 1e-05], mom=[(0.9, 0.99), (0.9, 0.99)]
[2025-04-09 03:09:10,279] [INFO] [timer.py:215:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=0.2303988460949335, CurrSamplesPerSec=0.337999630435394, MemAllocated=5.52GB, MaxMemAllocated=15.38GB
Epoch 2, Loss: -0.01171875, Positive Score: -0.265625, Negative Score: -0.25390625
